{"version":3,"sources":["book/demos/parent_child_ownership_relations.cljs"],"mappings":"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","names":["book.demos.parent-child-ownership-relations/initial-state","book.demos.parent-child-ownership-relations/delete-item","com.fulcrologic.fulcro.mutations/->Mutation","com.fulcrologic.fulcro.mutations/mutate","fulcro-mutation-env-symbol","map__89511","cljs.core/PROTOCOL_SENTINEL","cljs.core.apply.cljs$core$IFn$_invoke$arity$2","cljs.core/hash-map","cljs.core.get.cljs$core$IFn$_invoke$arity$2","p__89513","map__89514","env","temp__5735__auto__","com.fulcrologic.fulcro.algorithms.lookup/app-algorithm","default-action","list-id","id","state","taoensso.timbre._log_BANG_.cljs$core$IFn$_invoke$arity$10","taoensso.timbre/*config*","cljs.core/Delay","cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$2","s","cljs.core.update.cljs$core$IFn$_invoke$arity$4","cljs.core/dissoc","com.fulcrologic.fulcro.algorithms.merge/remove-ident*","options__72617__auto__","p__89516","map__89517","this","props","com.fulcrologic.fulcro.components/wrapped-render","map__89521","com.fulcrologic.fulcro.components/props","map__89524","com.fulcrologic.fulcro.components.get_computed.cljs$core$IFn$_invoke$arity$1","js/book","js/book.demos","js/book.demos.parent-child-ownership-relations","js/book.demos.parent-child-ownership-relations.Item","props__72618__auto__","this__72619__auto__","temp__5733__auto__","init-state__72620__auto__","obj89534","G__89535","G__89536","goog.object/get","obj89539","com.fulcrologic.fulcro.components/configure-component!","book.demos.parent-child-ownership-relations/Item","label","on-delete","computed","com.fulcrologic.fulcro.dom.macro_create_element.cljs$core$IFn$_invoke$arity$3","com.fulcrologic.fulcro.components/force-children","book.demos.parent-child-ownership-relations/ui-list-item","com.fulcrologic.fulcro.components.factory.cljs$core$IFn$_invoke$arity$2","map__89545","js/book.demos.parent-child-ownership-relations.ItemList","obj89550","G__89551","G__89552","obj89554","book.demos.parent-child-ownership-relations/ItemList","name","items","p","com.fulcrologic.fulcro.components.get_initial_state.cljs$core$IFn$_invoke$arity$2","com.fulcrologic.fulcro.components.get_query.cljs$core$IFn$_invoke$arity$1","delete-item","item-id","com.fulcrologic.fulcro.components.transact_BANG_.cljs$core$IFn$_invoke$arity$2","G__89547","item-props","i","com.fulcrologic.fulcro.components/computed","p1__89543#","cljs.core.map.cljs$core$IFn$_invoke$arity$2","G__89548","book.demos.parent-child-ownership-relations/ui-list","com.fulcrologic.fulcro.components.factory.cljs$core$IFn$_invoke$arity$1","map__89555","js/book.demos.parent-child-ownership-relations.Root","obj89563","G__89564","G__89565","obj89567","book.demos.parent-child-ownership-relations/Root","main-list"],"sourcesContent":["(ns book.demos.parent-child-ownership-relations\n  (:require\n    [com.fulcrologic.fulcro.dom :as dom]\n    [com.fulcrologic.fulcro.mutations :as m]\n    [com.fulcrologic.fulcro.components :as comp :refer [defsc]]\n    [com.fulcrologic.fulcro.algorithms.merge :as merge]\n    [taoensso.timbre :as log]))\n\n; Not using an atom, so use a tree for app state (will auto-normalize via ident functions)\n(def initial-state {:ui/react-key \"abc\"\n                    :main-list    {:list/id    1\n                                   :list/name  \"My List\"\n                                   :list/items [{:item/id 1 :item/label \"A\"}\n                                                {:item/id 2 :item/label \"B\"}]}})\n\n(m/defmutation delete-item\n  \"Mutation: Delete an item from a list\"\n  [{:keys [list-id id]}]\n  (action [{:keys [state]}]\n    (log/info \"Deleting item\" id \"from list\" list-id)\n    (swap! state\n      (fn [s]\n        (-> s\n          (update :items dissoc id)\n          (merge/remove-ident* [:items id] [:lists list-id :list/items]))))))\n\n(defsc Item [this\n             {:keys [item/id item/label] :as props}\n             {:keys [on-delete] :as computed}]              ;; <1>\n  {:initial-state (fn [{:keys [id label]}] {:item/id id :item/label label})\n   :query         [:item/id :item/label]\n   :ident         [:items :item/id]}\n  (dom/li label (dom/button {:onClick #(on-delete id)} \"X\")))\n\n(def ui-list-item (comp/factory Item {:keyfn :item/id}))\n\n(defsc ItemList [this {:list/keys [id name items]}]\n  {:initial-state (fn [p] {:list/id    1\n                           :list/name  \"List 1\"\n                           :list/items [(comp/get-initial-state Item {:id 1 :label \"A\"})\n                                        (comp/get-initial-state Item {:id 2 :label \"B\"})]})\n   :query         [:list/id :list/name {:list/items (comp/get-query Item)}]\n   :ident         [:lists :list/id]}\n  (let [delete-item (fn [item-id] (comp/transact! this [(delete-item {:list-id id :id item-id})])) ;; <2>\n        item-props  (fn [i] (comp/computed i {:on-delete delete-item}))]\n    (dom/div\n      (dom/h4 name)\n      (dom/ul\n        (map #(ui-list-item (item-props %)) items)))))\n\n(def ui-list (comp/factory ItemList))\n\n(defsc Root [this {:keys [main-list]}]\n  {:initial-state (fn [p] {:main-list (comp/get-initial-state ItemList {})})\n   :query         [{:main-list (comp/get-query ItemList)}]}\n  (dom/div (ui-list main-list)))\n\n\n"]}