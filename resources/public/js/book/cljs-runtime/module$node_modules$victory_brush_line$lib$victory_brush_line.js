shadow$provide.module$node_modules$victory_brush_line$lib$victory_brush_line=function(global,require,module,exports){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;"value"in descriptor&&(descriptor.writable=!0);Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,
protoProps,staticProps){protoProps&&_defineProperties(Constructor.prototype,protoProps);staticProps&&_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if("function"!==typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});superClass&&(Object.setPrototypeOf?
Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function _toConsumableArray(arr){if(Array.isArray(arr)){var JSCompiler_temp=0;for(var arr2=Array(arr.length);JSCompiler_temp<arr.length;JSCompiler_temp++)arr2[JSCompiler_temp]=arr[JSCompiler_temp];JSCompiler_temp=arr2}else JSCompiler_temp=void 0;JSCompiler_temp||(JSCompiler_temp=Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)?Array.from(arr):void 0);if(!(arr=JSCompiler_temp))throw new TypeError("Invalid attempt to spread non-iterable instance");
return arr}Object.defineProperty(exports,"__esModule",{value:!0});exports.default=void 0;var _pick2=_interopRequireDefault(require("module$node_modules$lodash$pick")),_isFunction2=_interopRequireDefault(require("module$node_modules$lodash$isFunction")),_defaults2=_interopRequireDefault(require("module$node_modules$lodash$defaults")),_assign2=_interopRequireDefault(require("module$node_modules$lodash$assign")),_react=_interopRequireDefault(require("module$node_modules$react$index"));global=_interopRequireDefault(require("module$node_modules$prop_types$index"));
var _victoryCore=require("module$node_modules$victory_core$lib$index"),_reactFastCompare=_interopRequireDefault(require("module$node_modules$react_fast_compare$index")),SMALL_NUMBER=1/Number.MAX_SAFE_INTEGER,getScale=function(props){var _props$scale=props.scale,scale=void 0===_props$scale?{}:_props$scale;_props$scale=props.dimension;_props$scale=void 0===_props$scale?"x":_props$scale;if(scale[_props$scale])return scale[_props$scale];scale=_victoryCore.Scale.getBaseScale(props,_props$scale);var range=
_victoryCore.Helpers.getRange(props,_props$scale);props=_victoryCore.Domain.getDomainFromProps(props,_props$scale)||[0,1];scale.range(range).domain(props);return scale},toRange=function(props,domain){props=getScale(props);return[props(Math.min.apply(Math,_toConsumableArray(domain))),props(Math.max.apply(Math,_toConsumableArray(domain)))]},toDomain=function(props,range){props=getScale(props);return[props.invert(Math.min.apply(Math,_toConsumableArray(range))),props.invert(Math.max.apply(Math,_toConsumableArray(range)))]},
withinBound=function(value,bound){return value>=_victoryCore.Collection.getMinValue(bound)&&value<=_victoryCore.Collection.getMaxValue(bound)},getBrushDomain=function(brushDomain,fullDomain){if(brushDomain){var brushMin=_victoryCore.Collection.getMinValue(brushDomain);brushDomain=_victoryCore.Collection.getMaxValue(brushDomain);var domainMin=_victoryCore.Collection.getMinValue(fullDomain),domainMax=_victoryCore.Collection.getMaxValue(fullDomain),defaultMin=brushMin<domainMin?domainMin:domainMax-SMALL_NUMBER;
domainMin=brushDomain>domainMax?domainMax:domainMin+SMALL_NUMBER;brushMin=withinBound(brushMin,fullDomain)?brushMin:defaultMin;fullDomain=withinBound(brushDomain,fullDomain)?brushDomain:domainMin;return[brushMin,fullDomain]}return fullDomain},getActiveHandle=function(props,position,range){var width=props.handleWidth/2,dimension=props.dimension;props=["min","max"].reduce(function(memo,type){var base={min:"x"===dimension?Math.min.apply(Math,_toConsumableArray(range)):Math.max.apply(Math,_toConsumableArray(range)),
max:"x"===dimension?Math.max.apply(Math,_toConsumableArray(range)):Math.min.apply(Math,_toConsumableArray(range))};memo[type]=withinBound(position,[base[type]-width,base[type]+width])?type:void 0;return memo},{});return props.min&&props.max?"both":props.min||props.max},panBox=function(props,position){var startPosition=props.startPosition,range=toRange(props,props.brushDomain),fullRange=getScale(props).range();props=Math.abs(range[1]-range[0]);var globalMin=Math.min.apply(Math,_toConsumableArray(fullRange));
fullRange=Math.max.apply(Math,_toConsumableArray(fullRange));startPosition=startPosition?startPosition-position:0;position=Math.min.apply(Math,_toConsumableArray(range))-startPosition;range=Math.max.apply(Math,_toConsumableArray(range))-startPosition;return[position>fullRange-props?fullRange-props:Math.max(position,globalMin),range<globalMin+props?globalMin+props:Math.min(range,fullRange)]},JSCompiler_object_inline_brushAreaStyle_2856={stroke:"none",fill:"black",opacity:function(d,a){return a?.2:
.1}},JSCompiler_object_inline_brushStyle_2857={pointerEvents:"none",stroke:"none",fill:"black",opacity:function(d,a){return a?.4:.3}},JSCompiler_object_inline_handleStyle_2858={pointerEvents:"none",stroke:"none",fill:"none"};require=function(_React$Component){function VictoryBrushLine(){if(!(this instanceof VictoryBrushLine))throw new TypeError("Cannot call a class as a function");var call=(VictoryBrushLine.__proto__||Object.getPrototypeOf(VictoryBrushLine)).apply(this,arguments);if(!call||"object"!==
typeof call&&"function"!==typeof call){if(void 0===this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");call=this}return call}_inherits(VictoryBrushLine,_React$Component);_createClass(VictoryBrushLine,[{key:"getRectDimensions",value:function(props,brushWidth,domain){var dimension=props.dimension,brushDomain=props.brushDomain;domain=domain||getBrushDomain(brushDomain,getScale(props).domain());domain=toRange(props,domain);var coordinates="x"===dimension?{y1:props.y1,
y2:props.y2,x1:Math.min.apply(Math,_toConsumableArray(domain)),x2:Math.max.apply(Math,_toConsumableArray(domain))}:{x1:props.x1,x2:props.x2,y1:Math.min.apply(Math,_toConsumableArray(domain)),y2:Math.max.apply(Math,_toConsumableArray(domain))};props=coordinates.x1;domain=coordinates.x2;brushDomain=coordinates.y1;coordinates=coordinates.y2;var JSCompiler_object_inline_x_2850="x"===dimension?0:brushWidth/2;brushWidth="y"===dimension?0:brushWidth/2;dimension=Math.min(props,domain)-JSCompiler_object_inline_x_2850;
var y=Math.min(brushDomain,coordinates)-brushWidth;return{x:dimension,y:y,width:Math.max(props,domain)+JSCompiler_object_inline_x_2850-dimension,height:Math.max(brushDomain,coordinates)+brushWidth-y}}},{key:"getHandleDimensions",value:function(props){var dimension=props.dimension,handleWidth=props.handleWidth,x1=props.x1,x2=props.x2,y1=props.y1,y2=props.y2,brushWidth=props.brushWidth||props.width,domain=getBrushDomain(props.brushDomain,getScale(props).domain());props=toRange(props,domain);x1=Math.min(x1,
x2)-brushWidth/2;x2=Math.min(y1,y2)-brushWidth/2;y1="x"===dimension?Math.min.apply(Math,_toConsumableArray(props))-handleWidth/2:x1;y2="x"===dimension?Math.max.apply(Math,_toConsumableArray(props))-handleWidth/2:x1;x1="y"===dimension?Math.max.apply(Math,_toConsumableArray(props))-handleWidth/2:x2;props="y"===dimension?Math.min.apply(Math,_toConsumableArray(props))-handleWidth/2:x2;x2="x"===dimension?handleWidth:brushWidth;dimension="x"===dimension?brushWidth:handleWidth;return{min:{x:y1,y:x1,width:x2,
height:dimension},max:{x:y2,y:props,width:x2,height:dimension}}}},{key:"getCursor",value:function(props){var dimension=props.dimension;props=props.activeBrushes;props=void 0===props?{}:props;return props.minHandle||props.maxHandle?"x"===dimension?"ew-resize":"ns-resize":props.brush?"move":"crosshair"}},{key:"renderHandles",value:function(props){var handleComponent=props.handleComponent,handleStyle=props.handleStyle,id=props.id,brushDomain=props.brushDomain,_props$datum=props.datum,datum=void 0===
_props$datum?{}:_props$datum;_props$datum=props.activeBrushes;_props$datum=void 0===_props$datum?{}:_props$datum;if(!brushDomain)return null;props=this.getHandleDimensions(props);handleStyle=(0,_assign2.default)({},JSCompiler_object_inline_handleStyle_2858,handleStyle);var minDatum=(0,_assign2.default)({handleValue:_victoryCore.Collection.getMinValue(brushDomain)},datum);brushDomain=(0,_assign2.default)({handleValue:_victoryCore.Collection.getMaxValue(brushDomain)},datum);datum=(0,_assign2.default)({key:"".concat(id,
"-min"),style:_victoryCore.Helpers.evaluateStyle(handleStyle,minDatum,_props$datum.minHandle)},props.min);id=(0,_assign2.default)({key:"".concat(id,"-max"),style:_victoryCore.Helpers.evaluateStyle(handleStyle,brushDomain,_props$datum.maxHandle)},props.max);return[_react.default.cloneElement(handleComponent,datum),_react.default.cloneElement(handleComponent,id)]}},{key:"renderBrush",value:function(props){var brushComponent=props.brushComponent,brushStyle=props.brushStyle,_props$activeBrushes3=props.activeBrushes;
_props$activeBrushes3=void 0===_props$activeBrushes3?{}:_props$activeBrushes3;var _props$datum2=props.datum;_props$datum2=void 0===_props$datum2?{}:_props$datum2;if(!props.brushDomain)return null;props=this.getRectDimensions(props,props.brushWidth||props.width);brushStyle=(0,_assign2.default)({},JSCompiler_object_inline_brushStyle_2857,brushStyle);brushStyle=_victoryCore.Helpers.evaluateStyle(brushStyle,_props$datum2,_props$activeBrushes3.brush);brushStyle=(0,_assign2.default)({style:brushStyle},
props);return _react.default.cloneElement(brushComponent,brushStyle)}},{key:"renderBrushArea",value:function(props){var brushAreaComponent=props.brushAreaComponent,brushAreaStyle=props.brushAreaStyle,_props$activeBrushes4=props.activeBrushes;_props$activeBrushes4=void 0===_props$activeBrushes4?{}:_props$activeBrushes4;var _props$datum3=props.datum;_props$datum3=void 0===_props$datum3?{}:_props$datum3;var brushAreaWidth=props.brushAreaWidth||props.width,cursor=this.getCursor(props);props=this.getRectDimensions(props,
brushAreaWidth,getScale(props).domain());brushAreaStyle=(0,_assign2.default)({cursor:cursor},JSCompiler_object_inline_brushAreaStyle_2856,brushAreaStyle);brushAreaStyle=_victoryCore.Helpers.evaluateStyle(brushAreaStyle,_props$datum3,_props$activeBrushes4.brushArea);brushAreaStyle=(0,_assign2.default)({style:brushAreaStyle},props);return _react.default.cloneElement(brushAreaComponent,brushAreaStyle)}},{key:"renderLine",value:function(props){var filteredProps=(0,_pick2.default)(props,"x1 x2 y1 y2 datum scale active style".split(" "));
return _react.default.cloneElement(props.lineComponent,filteredProps)}},{key:"render",value:function(){return _react.default.createElement("g",this.props.events,this.renderLine(this.props),this.renderBrushArea(this.props),this.renderBrush(this.props),this.renderHandles(this.props))}}]);return VictoryBrushLine}(_react.default.Component);exports.default=require;Object.defineProperty(require,"propTypes",{configurable:!0,enumerable:!0,writable:!0,value:{allowDrag:global.default.bool,allowDraw:global.default.bool,
allowResize:global.default.bool,brushAreaComponent:global.default.element,brushAreaStyle:global.default.object,brushAreaWidth:global.default.number,brushComponent:global.default.element,brushDimension:global.default.oneOf(["x","y"]),brushDomain:global.default.array,brushStyle:global.default.object,brushWidth:global.default.number,className:global.default.string,dimension:global.default.oneOf(["x","y"]),disable:global.default.bool,events:global.default.object,groupComponent:global.default.element,
handleComponent:global.default.element,handleStyle:global.default.object,handleWidth:global.default.number,id:global.default.oneOfType([global.default.number,global.default.string]),lineComponent:global.default.element,name:global.default.string,onBrushDomainChange:global.default.func,scale:global.default.object,style:global.default.object,type:global.default.string,width:global.default.number}});Object.defineProperty(require,"defaultProps",{configurable:!0,enumerable:!0,writable:!0,value:{allowDrag:!0,
allowDraw:!0,allowResize:!0,brushAreaComponent:_react.default.createElement(_victoryCore.Box,null),brushComponent:_react.default.createElement(_victoryCore.Box,null),groupComponent:_react.default.createElement("g",null),handleComponent:_react.default.createElement(_victoryCore.Box,null),handleWidth:10,lineComponent:_react.default.createElement(_victoryCore.LineSegment,null),width:10}});Object.defineProperty(require,"defaultEvents",{configurable:!0,enumerable:!0,writable:!0,value:function(props){return props.disable?
void 0:[{target:props.type,eventHandlers:{onMouseEnter:function(evt,targetProps){evt.preventDefault();var dimension=targetProps.dimension,allowResize=targetProps.allowResize,brushDomain=targetProps.brushDomain,parentSVG=targetProps.parentSVG||_victoryCore.Selection.getParentSVG(evt);evt=_victoryCore.Selection.getSVGEventCoordinates(evt,parentSVG)[dimension];dimension=getScale(targetProps).domain();brushDomain=getBrushDomain(brushDomain,dimension);var range=toRange(targetProps,brushDomain);allowResize=
allowResize&&getActiveHandle(targetProps,evt,range);var activeBrushes={brushArea:!targetProps.brushDomain,brush:withinBound(evt,range)&&!(0,_reactFastCompare.default)(dimension,brushDomain),minHandle:"min"===allowResize||"both"===allowResize,maxHandle:"min"===allowResize||"both"===allowResize};return[{mutation:function(){return{activeBrushes:activeBrushes,brushDomain:targetProps.brushDomain,parentSVG:parentSVG}}}]},onMouseDown:function(evt,targetProps){evt.preventDefault();var allowResize=targetProps.allowResize,
allowDrag=targetProps.allowDrag,allowDraw=targetProps.allowDraw,dimension=targetProps.dimension,activeBrushes=targetProps.activeBrushes,brushDomain=targetProps.brushDomain;if(!allowResize&&!allowDrag)return[];var fullDomain=getScale(targetProps).domain(),currentDomain=getBrushDomain(brushDomain,fullDomain),parentSVG=targetProps.parentSVG||_victoryCore.Selection.getParentSVG(evt),position=_victoryCore.Selection.getSVGEventCoordinates(evt,parentSVG)[dimension];evt=toRange(targetProps,currentDomain);
var activeHandle=allowResize&&getActiveHandle(targetProps,position,evt);return activeHandle?[{mutation:function(){return{parentSVG:parentSVG,isSelecting:!0,activeHandle:activeHandle,brushDomain:currentDomain,startPosition:position,activeBrushes:activeBrushes}}}]:withinBound(position,evt)&&!(0,_reactFastCompare.default)(fullDomain,currentDomain)?[{mutation:function(){return{isPanning:allowDrag,startPosition:position,brushDomain:currentDomain,activeBrushes:activeBrushes,parentSVG:parentSVG}}}]:allowDraw?
[{mutation:function(){return{isSelecting:allowResize,brushDomain:null,startPosition:position,activeBrushes:activeBrushes,parentSVG:parentSVG}}}]:[]},onMouseMove:function(evt,targetProps){var isPanning=targetProps.isPanning,isSelecting=targetProps.isSelecting,allowResize=targetProps.allowResize,allowDrag=targetProps.allowDrag,dimension=targetProps.dimension,onBrushDomainChange=targetProps.onBrushDomainChange,brushDomain=targetProps.brushDomain;if(isPanning||isSelecting)evt.preventDefault(),evt.stopPropagation();
var parentSVG=targetProps.parentSVG||_victoryCore.Selection.getParentSVG(evt);evt=_victoryCore.Selection.getSVGEventCoordinates(evt,parentSVG)[dimension];var fullDomain=getScale(targetProps).domain(),domain=getBrushDomain(brushDomain,fullDomain),initialRange=toRange(targetProps,domain),activeHandle=getActiveHandle(targetProps,evt,initialRange),activeBrushes={brushArea:!targetProps.brushDomain,brush:withinBound(evt,initialRange)&&!(0,_reactFastCompare.default)(fullDomain,domain),minHandle:"min"===
activeHandle||"both"===activeHandle,maxHandle:"max"===activeHandle||"both"===activeHandle};if(!targetProps.isPanning&&!targetProps.isSelecting)return[{mutation:function(){return{activeBrushes:activeBrushes,brushDomain:targetProps.brushDomain,parentSVG:parentSVG}}}];if(allowDrag&&isPanning){isSelecting=getScale(targetProps).range();dimension=panBox(targetProps,evt);activeHandle=toDomain(targetProps,dimension);var mutatedProps={startPosition:Math.max.apply(Math,_toConsumableArray(dimension))>=Math.max.apply(Math,
_toConsumableArray(isSelecting))||Math.min.apply(Math,_toConsumableArray(dimension))<=Math.min.apply(Math,_toConsumableArray(isSelecting))?targetProps.startPosition:evt,isPanning:!0,brushDomain:activeHandle,activeBrushes:{brush:!0},parentSVG:parentSVG};(0,_isFunction2.default)(onBrushDomainChange)&&onBrushDomainChange(activeHandle,(0,_defaults2.default)({},mutatedProps,targetProps));return[{mutation:function(){return mutatedProps}}]}if(allowResize&&isSelecting){allowResize=brushDomain||[0,SMALL_NUMBER];
allowResize=toRange(targetProps,allowResize);isPanning="min"===targetProps.activeHandle?"max":"min";(isPanning=targetProps.activeHandle&&"both"===getActiveHandle(targetProps,evt,allowResize)?isPanning:targetProps.activeHandle)?(allowDrag="x"===dimension?Math.max.apply(Math,_toConsumableArray(allowResize)):Math.min.apply(Math,_toConsumableArray(allowResize)),dimension="x"===dimension?Math.min.apply(Math,_toConsumableArray(allowResize)):Math.max.apply(Math,_toConsumableArray(allowResize)),allowResize=
toDomain(targetProps,["max"===isPanning?dimension:evt,"min"===isPanning?allowDrag:evt])):allowResize=toDomain(targetProps,[targetProps.startPosition,evt]);var _mutatedProps={brushDomain:allowResize,startPosition:targetProps.startPosition,isSelecting:isSelecting,activeHandle:isPanning,parentSVG:parentSVG,activeBrushes:{brush:!0,minHandle:"min"===activeHandle,maxHandle:"max"===activeHandle}};(0,_isFunction2.default)(onBrushDomainChange)&&onBrushDomainChange(allowResize,(0,_defaults2.default)({},_mutatedProps,
targetProps));return[{mutation:function(){return _mutatedProps}}]}return[]},onMouseUp:function(evt,targetProps){evt=targetProps.onBrushDomainChange;var brushDomain=targetProps.brushDomain,mutatedProps={isPanning:!1,isSelecting:!1,activeHandle:null,startPosition:null,brushDomain:brushDomain,activeBrushes:targetProps.activeBrushes};targetProps.allowResize&&(0,_isFunction2.default)(evt)&&evt(brushDomain,(0,_defaults2.default)({},mutatedProps,targetProps));return[{mutation:function(){return mutatedProps}}]},
onMouseLeave:function(evt,targetProps){var brushDomain=targetProps.brushDomain;return[{mutation:function(){return{isPanning:!1,isSelecting:!1,activeHandle:null,startPosition:null,brushDomain:brushDomain,activeBrushes:{}}}}]}}}]}})}
//# sourceMappingURL=module$node_modules$victory_brush_line$lib$victory_brush_line.js.map
